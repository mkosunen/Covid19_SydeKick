README of TheSDK-The System Development Kit
Initiated by Marko Kosunen, marko.kosunen@aalto.fi 7.8.2017
Last modification by Marko Kosunen, marko.kosunen@aalto.fi, 17.08.2018 15:17

OBS: THE SCRIPTS TO BE SOURCED ARE WRITTEN FOR T-SHELL
if you're using some other shell, change to tcsh or modify the scripts to be 
compliant with your shell.
~>tcsh

CONFIGURATION Quickstart
-Go to TheSDK directory and run 
~>./init_submodules
~>./configure

-Edit the TheSDK.config file so that the commands for matlab and python 
simulations are correct. 
Variables in TheSDK.config
--CONTROLLER [MATLAB|PYTHON] defines which of these you want to use for main
  simulation environment.

  Rest of the variables defines the commands used in Makefiles for simulation
  submission main thing to decide here is if you have LSF compliant cluster
  environment or not. Modify commands accordingly.


-Configure latex, matlab and MentorGraphics vsim tools to your path, 
modify sourceme.csh if needed and source it
~>source sourceme.csh

-If you are using python, you may need to install some modules locally.
run ./pip3.6userinstall.sh or modify it to be compliant with your current python
version.
~>./pip3userinstall.sh


HOW TO SIMULATE COVID19
cd Entities/covid19
./configure && make

To make documentation (after configuration
make doc

Read the doc
firefox doc/build/html/index.html



HOW TO USE TheSDK

TheSDK is a multi-tool simulation and developement environment for developing systems. 
It targets to using a single control environment to simulate,design and measure the 
system components with various tools by using a single "Control environment" for
control, analysis, and visualization of the resutls.

Implementation the "Control environment" is written in Object-oriented
Matlab and Python, but any high level versatile general programming language
supporting object oriented programming will do. Python/Matlab is selected based on
its good support for computing and signal processing, and support for
interfaces to measurement equipment. State of maturity between Python and Matlab may
different. 

NAMING AND STRUCTURE
The files are organized in directories as follows
                      TheSDK
configure
TheSDK.config (generated by configure)
Entities                                Simulations
    |                                       |
    entity1                                 Sim1
        entity1                                |
             |                                  configure
             __init__.py                        Makefile (generated by configure)
                                                  Slides
        vhd                                        |
            |                                       makearticle 
            entity1.vhd                             Sim1.tex     
            tb_entity1.vhd                          pdffiles     
        sv                                            |        
           |                                          Sim1.pdf
           entity1.sv                                         
           tb_entity1.sv                                  
        Simulations
            rtlsim
                |
                work

Guidelines to follow 
--All simulations configured, performed and results processed under Simulations directory
--All component descriptions, called Entities, regardless of the used tool/language are 
  located under Entities directory.


CLASS ORGANIZATION
The Entities and simulation setups are implemented as classes that  
cross-reference to each other without restrictions. In order to simplify this, 
    -Packages are not currently used as they would require package definitions
    in function calls everywhere.


EXAMPLE of class dependencies and relations
        
           
"@system_abstract_class" << thesdk << rtl
          \                 /          /
           \               /          /
             "system_sim"           /
                    |               /
                "system"          /
                    /\            /
       "entity1"  "entity2"
            |
      "entity3"


--thesdk is a class to collect methods common to "TheSDK"-framework, NOT
system_sim, system or entities. It should NOT contain anything specific to
a particular system. 
It should be superclass to all classes in TheSDK   

--rtl abstract class defines properties and methods that are required to 
run verilog and vhdl simulations.

If component does not have @verilog as a superclass, verilog-requirements do not 
apply. This is used to provide concise structure for verilog component models. 
Consequently, if component has an  model, it MUST  be a a subclass of @verilog. 
(Note: It is be best to define the tools used for RTL 
simulations in @rtl, but currently they are defined within component for syntax clarity)

--"system_abstract_class" may used as super class for the "@system_sim" and
    "system" to define the properties that typically 
        1) Are common to whole systems. 
        2) Need not to be altered between simulations, but are most often
        propagated through property inheritance.

Typically a simulation is controlled by "system_sim" class that controls 
the simulation providing methods like  "run" and  "plot".
(see Entities/inv_sim/inv_sim/__init__.py)

--Component properties are controlled and propagated by class constructor by copying the
    selected properties from immediate "parent". The properties that are to be copied are determined 
    by property "proplist".

COMPONENT HIERARCHY GUIDELINE
--Take FIRST a look at 
    Entities/inv_sim/inv_sim/__init__.py
    and
    Entities/inverter/inverter/__init__.py

--System is described in "system" class that determines the 
    sub-components and the interconnections in between them, and methods to 
    "run" the "system", i.e. how the signals propagate and in which order 
    the methods of components are executed.

--If the system is simple, "sim" class may also construct the system. 
    (see Entities/inv_sim/inv_sim/__init__.py)

Guidelines to be followed:
--- In general, a set of features related to certain mode of operation should be enforced with
    a abstract class whose usage is optional for an entity, like @verilog.

--Components are not subclasses to sim or system class as they should be
    independent of each other and transferrable between systems. 

---sim class is not a superclass to system class, as the "system" definitions 
    independent of how it is simulated.

SIGNAL PROPAGATION GUIDELINES
--Variables that present "signals" transfered from one class to another should
should be considered as a signal between components. Use of IOS bundle is
mandatory as __all__ simulation automation relies on correct IO definitio. See
inverter ecxample for reference..

WHAT NEXT?:
Take yout time to get acquainted with Entities/inverter and Entities/inv_sim
together with Entities/thesdk and Entities/rtl that should give you a picture how the things work.

Then read Simulation/Inverter/configure, and try to understand what happens there.
